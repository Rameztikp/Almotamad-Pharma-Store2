import{r as i,j as e,L as u}from"./index-DmWW7acS.js";import{A as N,B as $,K as w,L as I,M as O,N as v,E as A,G}from"./index-Dngo9_G4.js";const _=()=>{const[c,d]=i.useState([]),[S,g]=i.useState(!0),[o,C]=i.useState(""),[x,D]=i.useState("all"),[r,M]=i.useState(1),m=10;i.useEffect(()=>{(async()=>{try{const s=["نشط","منتهي","غير نشط"],a=["نسبة مئوية","مبلغ ثابت"],n=Array(15).fill(0).map((V,T)=>{const j=new Date,b=new Date;return b.setDate(j.getDate()+Math.floor(Math.random()*30)+1),{id:T+1,code:`DISCOUNT${Math.floor(1e3+Math.random()*9e3)}`,description:"خصم على جميع المنتجات",discountType:a[Math.floor(Math.random()*a.length)],discountValue:Math.floor(Math.random()*30)+5,minPurchase:Math.floor(Math.random()*100)+50,startDate:j.toISOString().split("T")[0],endDate:b.toISOString().split("T")[0],usageLimit:Math.floor(Math.random()*100)+10,usageCount:Math.floor(Math.random()*20),status:s[Math.floor(Math.random()*s.length)]}});d(n),g(!1)}catch(s){console.error("Error fetching coupons:",s),g(!1)}})()},[]);const k=async t=>{if(window.confirm("هل أنت متأكد من حذف هذا الكوبون؟ لا يمكن التراجع عن هذا الإجراء."))try{d(c.filter(s=>s.id!==t))}catch(s){console.error("Error deleting coupon:",s)}},F=async(t,s)=>{const a=s==="نشط"?"غير نشط":"نشط";try{d(c.map(n=>n.id===t?{...n,status:a}:n))}catch(n){console.error("Error updating coupon status:",n)}},L=c.filter(t=>{const s=t.code.toLowerCase().includes(o.toLowerCase())||t.description.toLowerCase().includes(o.toLowerCase()),a=x==="all"||t.status===x;return s&&a}),E=t=>{const s=new Date,a=new Date(t.startDate),n=new Date(t.endDate);return t.status==="منتهي"?"منتهي":s<a?"قادم":s>n?"منتهي":t.status},p=L.map(t=>({...t,displayStatus:E(t)})),f=r*m,P=f-m,y=p.slice(P,f),l=Math.ceil(p.length/m),h=t=>M(t);return S?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"إدارة الكوبونات"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"عرض وإدارة أكواد الخصم والعروض الترويجية"})]}),e.jsx("div",{className:"mt-4 md:mt-0",children:e.jsxs(u,{to:"/admin/coupons/new",className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[e.jsx(N,{className:"ml-2 -mr-1"}),"إضافة كوبون جديد"]})})]}),e.jsxs("div",{className:"mt-6 grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{htmlFor:"search",className:"block text-sm font-medium text-gray-700",children:"بحث"}),e.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[e.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:e.jsx($,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",id:"search",className:"focus:ring-blue-500 focus:border-blue-500 block w-full pr-10 sm:text-sm border-gray-300 rounded-md p-2 border text-right",placeholder:"ابحث برمز الكوبون أو الوصف",value:o,onChange:t=>C(t.target.value)})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700",children:"الحالة"}),e.jsxs("select",{id:"status",className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",value:x,onChange:t=>D(t.target.value),children:[e.jsx("option",{value:"all",children:"الكل"}),e.jsx("option",{value:"نشط",children:"نشط"}),e.jsx("option",{value:"غير نشط",children:"غير نشط"}),e.jsx("option",{value:"منتهي",children:"منتهي"}),e.jsx("option",{value:"قادم",children:"قادم"})]})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:y.length>0?e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الكود"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الوصف"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الخصم"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الحد الأدنى للشراء"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الصلاحية"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الاستخدام"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الحالة"}),e.jsx("th",{scope:"col",className:"relative px-6 py-3",children:e.jsx("span",{className:"sr-only",children:"إجراءات"})})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:y.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsx(w,{className:"h-5 w-5 text-blue-600"})}),e.jsx("div",{className:"mr-4",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.code})})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.description}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900",children:t.discountType==="نسبة مئوية"?e.jsxs("span",{className:"flex items-center",children:[e.jsx(I,{className:"ml-1 text-green-600"}),t.discountValue,"%"]}):e.jsxs("span",{className:"flex items-center",children:[e.jsx(O,{className:"ml-1 text-green-600"}),t.discountValue," ر.س"]})}),e.jsx("div",{className:"text-xs text-gray-500",children:t.discountType})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[t.minPurchase," ر.س"]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"text-sm text-gray-900",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(v,{className:"ml-1 text-gray-400"}),new Date(t.startDate).toLocaleDateString("ar-EG")]}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx(v,{className:"ml-1 text-gray-400"}),new Date(t.endDate).toLocaleDateString("ar-EG")]})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[t.usageCount," / ",t.usageLimit||"∞"]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${t.displayStatus==="نشط"?"bg-green-100 text-green-800":t.displayStatus==="منتهي"?"bg-red-100 text-red-800":t.displayStatus==="قادم"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:t.displayStatus})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex justify-end space-x-2 space-x-reverse",children:[e.jsxs(u,{to:`/admin/coupons/edit/${t.id}`,className:"text-blue-600 hover:text-blue-900",children:[e.jsx(A,{className:"inline ml-1"}),"تعديل"]}),e.jsx("button",{onClick:()=>F(t.id,t.status),className:`${t.status==="نشط"?"text-yellow-600 hover:text-yellow-900":"text-green-600 hover:text-green-900"}`,children:t.status==="نشط"?"تعطيل":"تفعيل"}),e.jsxs("button",{onClick:()=>k(t.id),className:"text-red-600 hover:text-red-900",children:[e.jsx(G,{className:"inline ml-1"}),"حذف"]})]})})]},t.id))})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"mx-auto h-12 w-12 text-gray-400",children:e.jsx(w,{className:"h-12 w-12 mx-auto"})}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"لا توجد كوبونات"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"ابدأ بإضافة كوبونات خصم جديدة لعملائك."}),e.jsx("div",{className:"mt-6",children:e.jsxs(u,{to:"/admin/coupons/new",className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[e.jsx(N,{className:"ml-2 -mr-1"}),"إضافة كوبون جديد"]})})]})}),l>1&&e.jsx("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6",children:e.jsxs("div",{className:"flex-1 flex justify-between sm:justify-end",children:[e.jsx("button",{onClick:()=>h(r>1?r-1:1),disabled:r===1,className:`relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md ${r===1?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-white text-gray-700 hover:bg-gray-50"}`,children:"السابق"}),e.jsx("div",{className:"hidden md:flex",children:Array.from({length:Math.min(5,l)},(t,s)=>{let a;return l<=5||r<=3?a=s+1:r>=l-2?a=l-4+s:a=r-2+s,e.jsx("button",{onClick:()=>h(a),className:`${r===a?"bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"} border-t-2 border-transparent px-4 pt-4 pb-3 text-sm font-medium`,children:a},s)})}),e.jsx("button",{onClick:()=>h(r<l?r+1:l),disabled:r===l,className:`ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md ${r===l?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-white text-gray-700 hover:bg-gray-50"}`,children:"التالي"})]})})]})};export{_ as default};
